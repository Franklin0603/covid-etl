[2023-06-22 23:50:48] INFO : => COVID PROJECT <= (main.py:105)
[2023-06-22 23:50:48] INFO : Starting ETL for Covid Data... (main.py:125)
[2023-06-22 23:50:48] INFO : => STARTING EXTRACT... (main.py:43)
[2023-06-22 23:50:53] INFO : Data extracted successfully from the URL. (extract.py:27)
[2023-06-22 23:50:53] INFO : Done extracting data from the URL. (main.py:55)
[2023-06-22 23:50:53] INFO : => STARTING TRANSFORM... (main.py:61)
[2023-06-22 23:50:53] INFO : Starting transform with nyt_cases_counties... (main.py:65)
[2023-06-22 23:50:57] INFO : Done transforming nyt_cases_counties. (main.py:67)
[2023-06-22 23:50:57] INFO : => STARTING VALIDATE... (main.py:75)
[2023-06-22 23:50:57] INFO : Starting data validation with nyt_cases_counties... (main.py:77)
[2023-06-22 23:50:58] WARNING : Data test cases_vs_deaths failed. Death counts cannot exceed case counts. (validate.py:159)
[2023-06-22 23:50:58] DEBUG : Data test unique_records passed. (validate.py:155)
[2023-06-22 23:50:58] DEBUG : Data test no_nulls_test passed. (validate.py:155)
[2023-06-22 23:50:58] DEBUG : Data test cases_range_test passed. (validate.py:155)
[2023-06-22 23:50:58] CRITICAL : Data test deaths_range_test failed. Deaths must be non-negative and <= 100K. (validate.py:157)
[2023-06-22 23:50:58] WARNING : 3/5 tests passed. (validate.py:167)
[2023-06-22 23:50:59] INFO : validate info saved successfully to data/validate_info_data/validate-info_20230622.csv. (validate.py:132)
[2023-06-22 23:50:59] INFO : => STARTING LOAD... (main.py:84)
[2023-06-22 23:50:59] INFO : Saving nyt_cases_counties data to local... (main.py:85)
[2023-06-22 23:51:23] INFO : Data saved successfully to data/save_data/covid_20230622.csv. (load.py:52)
[2023-06-22 23:51:23] INFO : Connected to MySQL database... (database_config.py:85)
[2023-06-22 23:51:23] INFO : covid_db database already exists. (database_config.py:183)
[2023-06-22 23:51:23] INFO : covid table is created in covid_db (database_config.py:206)
[2023-06-22 23:51:23] INFO : All rows have been removed from covid in covid_db (database_config.py:156)
[2023-06-22 23:51:26] CRITICAL : Failed to load data to covid_db.covid: (mysql.connector.errors.ProgrammingError) 1054 (42S22): Unknown column 'DATE' in 'field list'
[SQL: INSERT INTO covid (`DATE`, `COUNTY`, `STATE`, `FIPS`, `CASES`, `DEATHS`, `DB_DATE_UPLOAD`) VALUES (%(DATE)s, %(COUNTY)s, %(STATE)s, %(FIPS)s, %(CASES)s, %(DEATHS)s, %(DB_DATE_UPLOAD)s)]
[parameters: ({'DATE': datetime.datetime(2020, 1, 21, 0, 0), 'COUNTY': 'Snohomish', 'STATE': 'Washington', 'FIPS': '53061', 'CASES': 1, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)}, {'DATE': datetime.datetime(2020, 1, 22, 0, 0), 'COUNTY': 'Snohomish', 'STATE': 'Washington', 'FIPS': '53061', 'CASES': 1, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)}, {'DATE': datetime.datetime(2020, 1, 23, 0, 0), 'COUNTY': 'Snohomish', 'STATE': 'Washington', 'FIPS': '53061', 'CASES': 1, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)}, {'DATE': datetime.datetime(2020, 1, 24, 0, 0), 'COUNTY': 'Cook', 'STATE': 'Illinois', 'FIPS': '17031', 'CASES': 1, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)}, {'DATE': datetime.datetime(2020, 1, 24, 0, 0), 'COUNTY': 'Snohomish', 'STATE': 'Washington', 'FIPS': '53061', 'CASES': 1, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)}, {'DATE': datetime.datetime(2020, 1, 25, 0, 0), 'COUNTY': 'Orange', 'STATE': 'California', 'FIPS': '06059', 'CASES': 1, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)}, {'DATE': datetime.datetime(2020, 1, 25, 0, 0), 'COUNTY': 'Cook', 'STATE': 'Illinois', 'FIPS': '17031', 'CASES': 1, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)}, {'DATE': datetime.datetime(2020, 1, 25, 0, 0), 'COUNTY': 'Snohomish', 'STATE': 'Washington', 'FIPS': '53061', 'CASES': 1, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)}  ... displaying 10 of 10000 total bound parameter sets ...  {'DATE': datetime.datetime(2020, 3, 24, 0, 0), 'COUNTY': 'Monroe', 'STATE': 'Mississippi', 'FIPS': '28095', 'CASES': 3, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)}, {'DATE': datetime.datetime(2020, 3, 24, 0, 0), 'COUNTY': 'Montgomery', 'STATE': 'Mississippi', 'FIPS': '28097', 'CASES': 2, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)})]
(Background on this error at: https://sqlalche.me/e/14/f405) (database_config.py:236)
[2023-06-22 23:51:26] INFO : nyt_cases_counties data saved to local. (main.py:89)
[2023-06-22 23:51:26] INFO : Done running ETL for Covid Data (main.py:127)
[2023-06-22 23:53:57] INFO : => COVID PROJECT <= (main.py:105)
[2023-06-22 23:53:57] INFO : Starting ETL for Covid Data... (main.py:125)
[2023-06-22 23:53:57] INFO : => STARTING EXTRACT... (main.py:43)
[2023-06-22 23:54:02] INFO : Data extracted successfully from the URL. (extract.py:27)
[2023-06-22 23:54:02] INFO : Done extracting data from the URL. (main.py:55)
[2023-06-22 23:54:02] INFO : => STARTING TRANSFORM... (main.py:61)
[2023-06-22 23:54:02] INFO : Starting transform with nyt_cases_counties... (main.py:65)
[2023-06-22 23:54:06] INFO : Done transforming nyt_cases_counties. (main.py:67)
[2023-06-22 23:54:06] INFO : => STARTING VALIDATE... (main.py:75)
[2023-06-22 23:54:06] INFO : Starting data validation with nyt_cases_counties... (main.py:77)
[2023-06-22 23:54:07] WARNING : Data test cases_vs_deaths failed. Death counts cannot exceed case counts. (validate.py:159)
[2023-06-22 23:54:07] DEBUG : Data test unique_records passed. (validate.py:155)
[2023-06-22 23:54:07] DEBUG : Data test no_nulls_test passed. (validate.py:155)
[2023-06-22 23:54:07] DEBUG : Data test cases_range_test passed. (validate.py:155)
[2023-06-22 23:54:07] CRITICAL : Data test deaths_range_test failed. Deaths must be non-negative and <= 100K. (validate.py:157)
[2023-06-22 23:54:07] WARNING : 3/5 tests passed. (validate.py:167)
[2023-06-22 23:54:08] INFO : validate info saved successfully to data/validate_info_data/validate-info_20230622.csv. (validate.py:132)
[2023-06-22 23:54:08] INFO : => STARTING LOAD... (main.py:84)
[2023-06-22 23:54:08] INFO : Saving nyt_cases_counties data to local... (main.py:85)
[2023-06-22 23:54:34] INFO : Data saved successfully to data/save_data/covid_20230622.csv. (load.py:52)
[2023-06-22 23:54:34] INFO : Connected to MySQL database... (database_config.py:85)
[2023-06-22 23:54:34] INFO : covid_db database already exists. (database_config.py:183)
[2023-06-22 23:54:34] INFO : covid table is created in covid_db (database_config.py:206)
[2023-06-22 23:54:34] INFO : All rows have been removed from covid in covid_db (database_config.py:156)
[2023-06-22 23:54:37] CRITICAL : Failed to load data to covid_db.covid: (mysql.connector.errors.ProgrammingError) 1054 (42S22): Unknown column 'DATE' in 'field list'
[SQL: INSERT INTO covid (`DATE`, `COUNTY`, `STATE`, `FIPS`, `CASES`, `DEATHS`, `DB_DATE_UPLOAD`) VALUES (%(DATE)s, %(COUNTY)s, %(STATE)s, %(FIPS)s, %(CASES)s, %(DEATHS)s, %(DB_DATE_UPLOAD)s)]
[parameters: ({'DATE': datetime.datetime(2020, 1, 21, 0, 0), 'COUNTY': 'Snohomish', 'STATE': 'Washington', 'FIPS': '53061', 'CASES': 1, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)}, {'DATE': datetime.datetime(2020, 1, 22, 0, 0), 'COUNTY': 'Snohomish', 'STATE': 'Washington', 'FIPS': '53061', 'CASES': 1, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)}, {'DATE': datetime.datetime(2020, 1, 23, 0, 0), 'COUNTY': 'Snohomish', 'STATE': 'Washington', 'FIPS': '53061', 'CASES': 1, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)}, {'DATE': datetime.datetime(2020, 1, 24, 0, 0), 'COUNTY': 'Cook', 'STATE': 'Illinois', 'FIPS': '17031', 'CASES': 1, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)}, {'DATE': datetime.datetime(2020, 1, 24, 0, 0), 'COUNTY': 'Snohomish', 'STATE': 'Washington', 'FIPS': '53061', 'CASES': 1, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)}, {'DATE': datetime.datetime(2020, 1, 25, 0, 0), 'COUNTY': 'Orange', 'STATE': 'California', 'FIPS': '06059', 'CASES': 1, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)}, {'DATE': datetime.datetime(2020, 1, 25, 0, 0), 'COUNTY': 'Cook', 'STATE': 'Illinois', 'FIPS': '17031', 'CASES': 1, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)}, {'DATE': datetime.datetime(2020, 1, 25, 0, 0), 'COUNTY': 'Snohomish', 'STATE': 'Washington', 'FIPS': '53061', 'CASES': 1, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)}  ... displaying 10 of 10000 total bound parameter sets ...  {'DATE': datetime.datetime(2020, 3, 24, 0, 0), 'COUNTY': 'Monroe', 'STATE': 'Mississippi', 'FIPS': '28095', 'CASES': 3, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)}, {'DATE': datetime.datetime(2020, 3, 24, 0, 0), 'COUNTY': 'Montgomery', 'STATE': 'Mississippi', 'FIPS': '28097', 'CASES': 2, 'DEATHS': 0, 'DB_DATE_UPLOAD': datetime.datetime(2023, 6, 22, 0, 0)})]
(Background on this error at: https://sqlalche.me/e/14/f405) (database_config.py:236)
[2023-06-22 23:54:37] INFO : nyt_cases_counties data saved to local. (main.py:89)
[2023-06-22 23:54:37] INFO : Done running ETL for Covid Data (main.py:127)
